const fs = require('fs');
const path = require('path');
const { createCanvas, loadImage } = require('canvas');

// Base64 string of the KAiM logo (blue version)
const logoBase64 = `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAABQCAYAAAAnSfh8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAF0WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNy4yLWMwMDAgNzkuMWI2NWE3OWI0LCAyMDIyLzA2LzEzLTIyOjAxOjAxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjQuMCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjQtMDItMjhUMTQ6Mzc6MjYtMDg6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjQtMDItMjhUMTQ6Mzc6MjYtMDg6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDI0LTAyLTI4VDE0OjM3OjI2LTA4OjAwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjY5YzM2ZjI1LTM4ZGUtNDM5Mi1hMzA0LTNkODY4ZjI3YzM0ZiIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjY5YzM2ZjI1LTM4ZGUtNDM5Mi1h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`;

// Function to save base64 image
async function saveBase64Image(base64String, outputPath) {
  // Remove the data:image/png;base64, prefix if present
  const base64Data = base64String.replace(/^data:image\/\w+;base64,/, '');
  
  // Create buffer from base64
  const imageBuffer = Buffer.from(base64Data, 'base64');
  
  // Ensure directory exists
  const dir = path.dirname(outputPath);
  if (!fs.existsSync(dir)) {
    fs.mkdirSync(dir, { recursive: true });
  }
  
  // Write file
  fs.writeFileSync(outputPath, imageBuffer);
  console.log('Logo saved successfully!');
}

// Save the logo
const outputPath = path.join(__dirname, '..', 'public', 'images', 'kaim-logo.png');
saveBase64Image(logoBase64, outputPath);
